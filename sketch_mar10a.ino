void setup() {
  // put your setup code here, to run once:

#include <WiFi.h> 
#include <Wire.h>
#include <Adafruit_BMP085.h>
#include "DHT.h"
#define DHTPIN 4
#define DHTTYPE DHT22 

// select the input pin for the MQ-135 sensor
int sensorPin = 35; 
// variable to store the value coming from the sensor.
int val = 0; 

Adafruit_BMP085 bmp;
const char* ssid = "iPhone de jul"; 
const char* password = "derientoi";

WiFiServer server(80);

String header;
DHT dht(DHTPIN, DHTTYPE);

void setup() 
{
Serial.begin(115200);
if (!bmp.begin()) 
{
Serial.println("Not connected with BMP180/BMP085 sensor, check connections ");
while (1) {}
Serial.println(F("DHTxx test!"));

  dht.begin();
}

Serial.print("Connecting to Wifi Network");
Serial.println(ssid);
WiFi.begin(ssid, password);
while (WiFi.status() != WL_CONNECTED) {
delay(500);
Serial.print(".");
}
Serial.println("");
Serial.println("Successfully connected to WiFi.");
Serial.println("IP address of ESP32 is : ");
Serial.println(WiFi.localIP());
server.begin();
Serial.println("Server started");
}

void loop() {
  bmp180();
  mq135();
  dht11();
  webserveur();
  }

void bmp180(){
Serial.print("Temp = ");
Serial.print(bmp.readTemperature());
float temp = bmp.readTemperature();
Serial.println(" *C");

Serial.print("Pressure = ");
Serial.print(bmp.readPressure());
float pressure = bmp.readPressure();
Serial.println(" Pa");


Serial.print("Altitude = ");
Serial.print(bmp.readAltitude());
float alt = bmp+readAltitude();
Serial.println(" meters");


Serial.println();
delay(2000);
}
void mq135(){
      // read the value from the sensor
  val = analogRead(sensorPin);
  Serial.println (val);
  delay(1000);
  }
void dht11(){
   float h = dht.readHumidity();
   Serial.print(F("Humidity: "));
   Serial.print(h);
  }
void webserveur(){
WiFiClient client = server.available();
if (client) 
{ 
Serial.println("Web Client connected ");
String request = client.readStringUntil('\r'); 
client.println("HTTP/1.1 200 OK");
client.println("Content-type:text/html");
client.println("Connection: close");
client.println();
client.println("{% load static %}<html> <head> <title>MagicBox</title> <link rel=\"stylesheet\" type=\"text/css\" href=\"{% static 'index.css' %}\"/> <!-- <link rel=\"stylesheet\" type=\"text/css\" href=\"index.css\"/> --> <script src=\"static/js/jquery-3.6.0.min.js\"></script> <script src=\"static/js/paho-mqtt.js\"></script> <script src=\"https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js\" type=\"text/javascript\"></script> <link href=\"https://fonts.googleapis.com/css2?family=Quicksand&display=swap\" rel=\"stylesheet\" /> <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/css/bootstrap.min.css\"><link rel=\"stylesheet\" href=\"./style.css\"> <link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\"> <link rel=\"stylesheet\" type=\"text/css\" href=\"styles.min.css\"> <link href=\"https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900\" rel=\"stylesheet\"> <script src=\"https://use.fontawesome.com/68cbe5c16f.js\"></script> <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js\"></script> <link rel=\"stylesheet\" type=\"text/css\" href=\"css/styles.min.css\"> <script src=\"dashboard.js\"></script> <script src=\"lightSensorControl.js\"></script> <style type=\"text/css\"> .container { background: #642b73; /* fallback for old browsers */ /* Chrome 10-25, Safari 5.1-6 */ background: linear-gradient(to right, #c6426e, #642b73); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */ height: calc(100vh - 60px); color: #151515; padding: 30px; } .container, .actualMSG, .graphique{ padding: 40px; } .su{ width: 250px; } .peri{ float: right; width: 155px; } .titre{ text-align: center; font-family: sans-serif; font-size: 36px; margin-bottom: 60px; margin-top: 40px; text-decoration: underline; color: #52B5E5; } .liste{ border: 2px solid; border-color: #1D2769; border-top: 2px solid #52B5E5; padding: 20px; } .liste_elem{ font-size: 16px; margin-left: 20px; margin-bottom: 15px; }:last-child{ margin-bottom: 0; } a{ color: black; } /* .actualVal, .actualMSG{ float: left; padding: 40px 0 40px 0; width: 50%; } */ .section_title{ color: #1D2769; } /* .section_photo,.actualVal_txt{ padding-left: 40px; } .actualVal_content{ text-align: center; } .actualVal_txt{ float: left; margin-right: 20px; font-size: 18px; } .actualVal_val{ float: left; font-size: 18px; } */ .actualMSG_section{ display: flow-root; } .actualMSG_txt{ float: left; margin-right: 20px; } .switch { position: relative; display: inline-block; width: 60px; height: 26px; top: 10px; } /* Hide default HTML checkbox */ .switch input { opacity: 0; width: 0; height: 0; } /* The slider */ .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; -webkit-transition: .4s; transition: .4s; } .slider:before { position: absolute; content: \"\"; height: 20px; width: 20px; left: 5px; bottom: 3px; background-color: white; -webkit-transition: .4s; transition: .4s; } input:checked + .slider { background-color: #52B5E5; } input:focus + .slider { box-shadow: 0 0 1px #52B5E5; } input:checked + .slider:before { -webkit-transform: translateX(30px); -ms-transform: translateX(30px); transform: translateX(30px); } /* Rounded sliders */ .slider.round { border-radius: 34px; } .slider.round:before { border-radius: 50%; } .input_msg{ padding: 5px 15px; margin-left: 20px; border: 2px solid; border-color: #1D2769; border-top: 2px solid #52B5E5; } .submit{ width: 60px; background-color: white; border: 2px solid; border-color: #1D2769; border-top: 2px solid #52B5E5; padding: 5px 15px; } .submit:hover{ background-color: #1D2769; color: white; } .graphique{ display: flow-root; } .graphique_txt{ text-align: center; } .footer{ display: inline-block; width: 100%; padding: 40px 0; } .footer_txt{ text-align: center; } .website{ border: 2px solid black; padding: 5px 10px; font-weight: bold; } .website:hover{ background-color: black; color: white; } .author{ font-family: 'agilia'; font-size: 24px; margin-top: 60px; color: #1D2769; } /* ================================================================= */ #stage { padding: 30px; width: auto; margin-top: 10px; box-shadow: 2px 2px 15px rgb(0, 0, 0); } body { font-family: \"Quicksand\", sans-serif; } .container { background: #642b73; /* fallback for old browsers */ /* Chrome 10-25, Safari 5.1-6 */ background: linear-gradient(to right, #c6426e, #642b73); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */ height: calc(100vh - 60px); color: #151515; padding: 30px; } .container { display: flex; margin: 0 auto; /* align-items: center; */ justify-content: center; width: auto; height: fit-content; } .container .slogan { max-width: 600px; padding: 8px 15px; background: #fffff3; border-radius: 3px; transition: all 0.3s ease-in-out; box-shadow: 0 0 45px 0 #6e2e72; } .container p { display: block; font-weight: 700; font-size: 2em; position: relative; text-align: center; transition: all 0.3s ease-in-out; } .words { text-align: left; width: 180px; height: 20px; display: inline-block; overflow: hidden; -webkit-animation: changewords 7s infinite; animation: changewords 7s infinite; } .word { color: #de6449; position: absolute; top: 0; height: 60px; width: 80px; overflow: hidden; -webkit-animation: changewordfirst 7s infinite; animation: changewordfirst 7s infinite; } .word:nth-of-type(2) { width: 80px; color: #791e94; -webkit-animation: changewordsecond 7s infinite; animation: changewordsecond 7s infinite; } .word:nth-of-type(3) { width: 80px; color: #41d3bd; -webkit-animation: changewordthird 7s infinite; animation: changewordthird 7s infinite; } @-webkit-keyframes changewordfirst { 0% { width: 160px; } 16.5% { width: 160px; } 25% { width: 0; } 93.75% { width: 0; } 100% { width: 160px; } } @keyframes changewordfirst { 0% { width: 160px; } 16.5% { width: 160px; } 25% { width: 0; } 93.75% { width: 0; } 100% { width: 160px; } } @-webkit-keyframes changewordsecond { 0% { width: 0; } 25% { width: 0; } 33% { width: 195px; } 50% { width: 195px; } 58.25% { width: 0; } 100% { width: 0; } } @keyframes changewordsecond { 0% { width: 0; } 25% { width: 0; } 33% { width: 195px; } 50% { width: 195px; } 58.25% { width: 0; } 100% { width: 0; } } @-webkit-keyframes changewordthird { 0% { width: 0; } 58.25% { width: 0; } 66% { width: 118px; } 85% { width: 118px; } 93.75% { width: 0; } 100% { width: 0; } } @keyframes changewordthird { 0% { width: 0; } 58.25% { width: 0; } 66% { width: 118px; } 85% { width: 118px; } 93.75% { width: 0; } 100% { width: 0; } } @-webkit-keyframes changewords { 0% { width: 160px; } 16.5% { width: 160px; } 25% { width: 0; } 33% { width: 195px; } 50% { width: 195px; } 58.25% { width: 0; } 66% { width: 118px; } 85% { width: 118px; } 93.75% { width: 0; } 100% { width: 160px; } } @keyframes changewords { 0% { width: 160px; } 16.5% { width: 160px; } 25% { width: 0; } 33% { width: 195px; } 50% { width: 195px; } 58.25% { width: 0; } 66% { width: 118px; } 85% { width: 118px; } 93.75% { width: 0; } 100% { width: 160px; } } /* ===============================Paramètres BlockQuote================================== */ blockquote { display: block; background: #fff; padding: 15px 20px 15px 45px; margin: 0 0 20px; position: relative; /*Font*/ font-family: Georgia, serif; font-size: 16px; line-height: 1.2; color: #666; text-align: justify; /*Borders - (Optional)*/ border-left: 15px solid purple; /*Box Shadow - (Optional)*/ -moz-box-shadow: 2px 2px 15px #ccc; -webkit-box-shadow: 2px 2px 15px #ccc; box-shadow: 2px 2px 15px #ccc; } blockquote::before { content: \"\201C\"; /*Unicode for Left Double Quote*/ /*Font*/ font-family: Georgia, serif; font-size: 60px; font-weight: bold; color: #999; /*Positioning*/ position: absolute; left: 10px; top: 5px; } blockquote::after { /*Reset to make sure*/ content: \"\"; } blockquote a { text-decoration: none; background: #eee; cursor: pointer; padding: 0 3px; color: #c76c0c; } blockquote a:hover { color: #666; } blockquote em { font-style: italic; } /* ===========================Fin Paramètres blockQuote====================================== */ /* ================================ Paramètres généraux ============================================= */ body { font-family: \"Quicksand\", sans-serif; } #remarque { padding: 30px; width: auto; box-shadow: 2px 2px 15px rgb(0, 0, 0); border-radius: 0.5em; } #adimaker { padding: 30px; width: auto; margin-top: 10px; box-shadow: 2px 2px 15px rgb(0, 0, 0); } #salles { padding: 30px; width: auto; margin-top: 10px; box-shadow: 2px 2px 15px rgb(0, 0, 0); } #stage { padding: 30px; width: auto; margin-top: 10px; box-shadow: 2px 2px 15px rgb(0, 0, 0); } #anecdotes { padding: 30px; width: auto; margin-top: 10px; box-shadow: 2px 2px 15px rgb(0, 0, 0); } .danger { background-color: #ffdddd; border-left: 6px solid #f44336; margin-bottom: 15px; padding: 4px 12px; } .success { background-color: #ddffdd; border-left: 6px solid #04aa6d; margin-bottom: 15px; padding: 4px 12px; } .info { background-color: #e7f3fe; border-left: 6px solid #2196f3; margin-bottom: 15px; padding: 4px 12px; } .warning { background-color: #ffffcc; border-left: 6px solid #ffeb3b; margin-bottom: 15px; padding: 4px 12px; } h2 { text-transform: uppercase; } .brigans:hover { animation: shake 0.5s; animation-iteration-count: infinite; } @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 30% { transform: translate(3px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(3px, 1px) rotate(-1deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 90% { transform: translate(1px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } } /* ===================================== Fin paramètres généraux ============================================= */ .data { font-family: \"Roboto\", sans-serif; font-weight: 100; position: absolute; width: 100%; } i { color: #ddd !important; } .material-icons { font-size: 1.3vw; } .ourside { color: red; } .drag { position: absolute; } #window-container { height: 40vw; width: 80vw; position: relative; left: 10vw; top: 10vh; } .window { perspective: 800px; color: #ffffff; border-radius: 2%; height: 49%; position: absolute; background: #141d2d; box-shadow: 0 1vmin 1.5vmin #121417; } .right { position: absolute; right: 0; top: 0; } #temp { top: 0; left: 0; width: 60%; } #light { top: 0; right: 0; width: 38%; } #electricity { bottom: 0; right: 0; width: 30%; } #gas { bottom: 0; left: 0; width: 30%; } .fa-cloud { color: #676f7a; } .header { float: top; color: #676f7a; font-size: 80%; position: absolute; width: 90%; height: 10%; top: 2%; left: 5%; } .header .header-left { left: 0; } .header .header-right { top: 0; right: 15%; } .currentWeather { transition: top 0.2s ease-in-out; overflow: hidden; color: #ffffff; position: absolute; width: 100%; height: 100%; text-align: center; font-size: 7vw; line-height: 36vh; } .currentWeather span { left: 0; } .currentHumidity { transition: top 0.2s ease-in-out; overflow: hidden; color: #ffffff; position: absolute; width: 100%; height: 100%; text-align: center; font-size: 7vw; line-height: 36vh; } .currentHumidity span { left: 0; } .currentElectricity { transition: top 0.2s ease-in-out; overflow: hidden; color: #ffffff; position: absolute; width: 100%; height: 100%; text-align: center; font-size: 7vw; line-height: 36vh; } .currentElectricity span { left: 0; } .currentElectricity #kwh { font-size: 5vw; } .currentGas { transition: top 0.2s ease-in-out; overflow: hidden; color: #ffffff; position: absolute; width: 100%; height: 100%; text-align: center; font-size: 5vw; line-height: 36vh; } .currentGas span { left: 0; } .currentCo { transition: top 0.2s ease-in-out; overflow: hidden; color: #ffffff; position: absolute; width: 100%; height: 100%; text-align: center; font-size: 5vw; line-height: 36vh; } .currentCo span { left: 0; } #C { position: absolute; top: 2.5%; height: 95%; width: 50%; border-right: 1px solid #3a3d44; } #C #C_graph { transition: bottom 0.7s ease-in-out; position: absolute; width: 95%; height: 85%; bottom: 0; left: 2.5%; } #E { position: absolute; top: 2.5%; height: 95%; width: 100%; } #L { position: absolute; top: 2.5%; height: 95%; width: 100%; } #G_graph { transition: bottom 0.7s ease-in-out; position: absolute; width: 95%; height: 85%; bottom: 15%; left: 2.5%; } #Co { position: absolute; right: 2.5%; top: 2.5%; height: 95%; width: 95%; } #Co_graph { transition: bottom 0.7s ease-in-out; position: absolute; width: 95%; height: 85%; bottom: 15%; left: 2.5%; } #W { position: absolute; top: 2.5%; height: 95%; width: 100%; } #H { position: absolute; right: 0; bottom: 2.5%; height: 95%; width: 50%; } #H #H_graph { transition: bottom 0.7s ease-in-out; position: absolute; width: 95%; height: 85%; bottom: 0; left: 2.5%; } #E_graph { transition: bottom 0.7s ease-in-out; position: absolute; width: 95%; height: 85%; bottom: 0.5%; left: 2.5%; } .jauge { overflow: hidden; margin: auto; text-align: center; position: absolute; width: 16.5vw; height: 16.5vw; border: 5px solid #262830; border-radius: 50%; border-left-color: #cbff82; border-bottom-color: transparent; top: 0; left: 0; bottom: -10%; right: 0; } .jauge span { width: 100%; position: absolute; left: 0; bottom: 35%; font-size: 5vw; font-family: \"Roboto\", sans-serif; font-weight: 100; } #lightPercentage { top: 10%; position: absolute; left: 2.5%; width: 95%; height: 90%; } #lightCanvas { position: absolute; top: 0; width: 100%; height: 100%; margin: auto; } #lightinput { font-size: 40px; position: absolute; width: 100%; height: 20%; top: 40%; } #percentageValue { top: 0; height: 100%; width: 20%; right: 40%; position: absolute; } #percentageIncrement { text-align: center; top: 0; height: 100%; width: 10%; right: 25%; position: absolute; cursor: pointer; } #percentageDecrement { text-align: center; position: absolute; top: 0; height: 100%; width: 10%; left: 25%; cursor: pointer; }</style> </head> <body> <script type=\"text/javascript\">function pie(canvas,context,value){ context.clearRect(0, 0, canvas.width, canvas.height); var height = canvas.height; var width = canvas.width; var i = 0; if(value>=100) value = 100 var angle = (2*Math.PI)/200; var a = angle; var d = height/2.2; while(i<100){ context.beginPath(); context.arc(width/2, height/2, d, a-angle,a); context.fillStyle=\"#10151f\" context.lineTo(width/2, height/2) context.fill(); i++; a+=2*angle; } i=0; a=-Math.PI/2 + angle; while(i<value){ context.beginPath(); context.arc(width/2, height/2, d, a-angle,a); context.fillStyle=\"#00BCD4\" context.lineTo(width/2,height/2) context.fill(); i++; a+=2*angle; } context.beginPath(); context.arc(width/2, height/2, d*0.85, 0, 2*Math.PI); context.fillStyle=\"#141d2d\" context.fill(); } function graph(canvas){ var context = canvas.getContext(\"2d\"); var width = canvas.width, height = canvas.height; if(canvas==document.getElementById(\"E_graph\") || canvas==document.getElementById(\"C_graph\") || canvas==document.getElementById(\"H_graph\")){ var fillGradient = context.createLinearGradient(0,height,width,height); fillGradient.addColorStop(0,\"#31414c\"); fillGradient.addColorStop(1,\"#263e49\"); var strokeGradient = context.createLinearGradient(0,height,width,height); strokeGradient.addColorStop(0,\"#80DEEA\"); strokeGradient.addColorStop(1,\"#00BCD4\"); } else if(canvas==document.getElementById(\"G_graph\") || canvas==document.getElementById(\"Co_graph\")){ var fillGradient = context.createLinearGradient(0,height,width,height); fillGradient.addColorStop(0,\"#344443\"); fillGradient.addColorStop(1,\"#394441\"); var strokeGradient = context.createLinearGradient(0,height,width,height); strokeGradient.addColorStop(0,\"#91ff8f\"); strokeGradient.addColorStop(1,\"#cbff82\"); } var fadeGradient = context.createLinearGradient(0,height,0,0); fadeGradient.addColorStop(0,\"rgba(20, 29, 45, 1)\"); fadeGradient.addColorStop(0.4,\"rgba(20, 29, 45, 0)\"); context.lineWidth = 1; var val = height - (height/3 + Math.random()*height/5); context.fillStyle=fillGradient; context.strokeStyle=strokeGradient; context.moveTo(0,val); if(canvas==document.getElementById(\"G_graph\") || canvas==document.getElementById(\"Co_graph\")){ for(var i=0; i<width; i+=width/20){ context.lineTo(i,val); val = height - (height/7 + Math.random()*height/5) } } else { for(var i=0; i<width; i+=width/40){ context.lineTo(i,val+i/5); val = height - (height/3 + Math.random()*height/5) } } context.lineTo(width, height); context.lineTo(0,height); context.fill(); context.stroke(); context.fillStyle=fadeGradient; context.fill(); } $(document).ready(function(){ var percentVal = 80; var lightCanvas = this.getElementById(\"lightCanvas\"); var context = lightCanvas.getContext(\"2d\"); lightCanvas.height = $(\"#lightPercentage\").height(); lightCanvas.width = $(\"#lightPercentage\").width(); pie(lightCanvas,context,percentVal); $(\"#percentageIncrement\").click(function(){ console.log(lightCanvas.height); if(percentVal!=100) percentVal++; $(\"#percentageValue\").html(percentVal+\"%\"); pie(lightCanvas,context, percentVal) }); $(\"#percentageDecrement\").click(function(){ percentVal--; $(\"#percentageValue\").html(percentVal+\"%\"); pie(lightCanvas,context, percentVal) }); var C_canvas = this.getElementById(\"C_graph\"); C_canvas.height = $(\"#C\").height()*0.85; C_canvas.width = $(\"#C\").width()*0.95; graph(C_canvas); var H_canvas = this.getElementById(\"H_graph\"); H_canvas.height = $(\"#H\").height()*0.85; H_canvas.width = $(\"#H\").width()*0.95; graph(H_canvas); var E_canvas = this.getElementById(\"E_graph\"); E_canvas.height = $(\"#electricity\").height()*0.85; E_canvas.width = $(\"#electricity\").width()*0.95; graph(E_canvas); var Co_canvas = this.getElementById(\"Co_graph\"); Co_canvas.height = $(\"#Co\").height()*0.85; Co_canvas.width = $(\"#Co\").width()*0.95; graph(Co_canvas); var temperature = $(\"#C\"); var humidity = $(\"#H\"); temperature.on(\"mouseover\", function(e){ $(\".currentWeather\").css(\"top\",\"1%\"); $(\"#C_graph\").css(\"bottom\",\"1%\"); }) .on(\"mouseout\",function(){ $(\".currentWeather\").css(\"top\",0); $(\"#C_graph\").css(\"bottom\",0); }); humidity.on(\"mouseover\", function(e){ $(\".currentHumidity\").css(\"top\",\"1%\"); $(\"#H_graph\").css(\"bottom\",\"1%\"); }) .on(\"mouseout\",function(){ $(\".currentHumidity\").css(\"top\",0); $(\"#H_graph\").css(\"bottom\",0); }); });</script> <!-- <img class=\"su\" src=\"static/Sciences_SU.png\" /> --> <center><img class=\"su\" src=\"static/magic.png\" /></center> <!-- <img class=\"peri\" src= \"static/peri.png\" /> --> <a href=\"index.html\" style=\"text-decoration: none\" ><div class=\"container\"> <div class=\"slogan\"> <p> ADI <span class=\"words\"> <span class=\"word\">DJANGO</span> <span class=\"word\">MARIA</span> <span class=\"word\">CODE</span> </span> </p> </div> </div></a > <section class=\"adimaker\"> <div id=\"window-container\"> <!--The temperature and humidity window--> <div class=\"window\" id = \"temp\"> <div id=\"C\"> <div class=\"header\"> <div class=\"drag header-left\"> <i class=\"material-icons\">cloud_queue</i> </div> <div id=\"outside\" class=\"drag header-right\"> Outside: 26°C </div> <div class=\"right\"> <i class=\"material-icons\">show_chart</i> </div> </div> <canvas id=\"C_graph\"></canvas> <div class=\"currentWeather\"><span class=\"data\">" + temp +"°C</span></div> </div> <div id=\"H\"> <div class=\"header\"> <div class=\"drag header-left\"> <i class=\"material-icons\">invert_colors</i> </div> <div class=\"outside drag header-right\"> Outside: 70% </div> <div class=\"right\"> <i class=\"material-icons\">show_chart</i> </div> </div> <canvas id=\"H_graph\"></canvas> <div class=\"currentHumidity\"> <span class=\"data\">" + h +" %</span> </div> </div> </div> <!--light sensor window--> <div class=\"window\" id = \"light\"> <div id=\"L\"> <div class=\"header\"> <i class=\"material-icons\">lightbulb_outline</i> <div class=\"right\"> <i class=\"material-icons\">show_chart</i> </div> </div> <div id=\"lightPercentage\" class=\"data\"> <canvas id=\"lightCanvas\"></canvas> <div id=\"lightinput\"> <div id=\"percentageIncrement\">+</div> <div id=\"percentageValue\">80%</div> <div id=\"percentageDecrement\">-</div> </div> </div> </div> </div> <!--Gas and Co sensor window--> <div class=\"window\" id = \"gas\"> <div id=\"Co\"> <div class=\"header\"> <i class=\"material-icons\">error_outline</i> <div class=\"outside drag header-right\"> GAZ TOXIQUE : Co </div> <div class=\"right\"> <i class=\"material-icons\">show_chart</i> </div> </div> <div class=\"jauge\"> <span>SAFE</span> <canvas id=\"Co_graph\"></canvas> </div> <div class=\"GasCo\"> </div> </div> </div> <!--Electricity consumption for the day--> <div class=\"window\" id = \"electricity\"> <div id=\"E\"> <div class=\"header\"> <div class=\"drag header-left\"> <i class=\"material-icons\">flash_on</i> </div> <div class=\"outside drag header-right\"> Today </div> <div class=\"right\"> <i class=\"material-icons\">show_chart</i> </div> </div> <canvas id=\"E_graph\"></canvas> <div class=\"currentElectricity\"> <span class=\"data\">" + alt + "<span id=\"kwh\"> M</span> </span> </div> </div> </div> </div></section> <section id=\"remarque\"> <h2>Une petite envie de check les capteurs ?</h2> <hr /> <br /> <p> <ul class=\"liste\" style=\"list-style: none\"> <li class=\"liste_elem\">Température ?<a href=\"#adimaker\"> cliquez ici</a></li> <li class=\"liste_elem\">Humidité ?<a href=\"#adimaker\"> cliquez ici</a></li> <li class=\"liste_elem\">Pression ?<a href=\"#adimaker\"> cliquez ici</a></li> </ul> </p> </section> <section id=\"adimaker\"> <h2>Valeur n°1</h2> <hr /> <div id=\"actualVal\" class=\"actualVal\"> <h2 class=\"section_title section_photo\">Température</h2> <div class=\"actualVal_content\"> <p class=\"actualVal_txt\">Voici la valeur actuelle de notre temp&eacute;rature : </p> <!-- Valeurs passée en paramètre du rendu --> <p id=\"current_value\" class=\"actualVal_val\">{{value}}</p> </div> </div> <br /> <div id=\"actualVal\" class=\"actualVal\"> <h2 class=\"section_title section_photo\">Humidit&eacute;</h2> <div class=\"actualVal_content\"> <p class=\"actualVal_txt\">Voici la valeur actuelle de notre Humidit&eacute; : </p> <!-- Valeurs passée en paramètre du rendu --> <p id=\"current_value\" class=\"actualVal_val\">{{value}}</p> </div> </div> <br /> <div id=\"actualVal\" class=\"actualVal\"> <h2 class=\"section_title section_photo\">Pression</h2> <div class=\"actualVal_content\"> <p class=\"actualVal_txt\">Voici la valeur actuelle de notre Pression : </p> <!-- Valeurs passée en paramètre du rendu --> <p id=\"current_value\" class=\"actualVal_val\">{{value}}</p> </div> </div> </section> <br /> <section id=\"adimaker\"> <div id=\"graphique\" class=\"graphique\"> <h2 class=section_title>GRAPHIQUE</h2> <p class=\"graphique_txt\">Voici le graphique représentant l'évolution des valeurs communiqué par le DHT22</p> <script type=\"text/javascript\"> var element = document.getElementById(\"current_value\") window.onload = function () { // Notre data points dps = []; // Nous récupérons les données au format JSON depuis la route \"/data\" $.getJSON('/data', function(data) { // Valeurs initiales affichée sur le graphe for (let index = 10; index >= 0; index--) { dps.push({x: 10-index, y: data[index].value}); } }); // Format du graphe var chart = new CanvasJS.Chart(\"chartContainer\",{ theme: \"light1\", title :{ text: \"Live Data\" }, axisX: { title: \"\" }, axisY: {title: \"\" }, data: [{ type: \"line\", dataPoints : dps, color :\"purple\" }] }); // Afficher le graphge chart.render(); var xVal = 10 + 1; var yVal = 15; var updateInterval = 1000; // Mise à jour du graphe toutes les secondes // (en lien avec la fréquence d'envoie de message sur l'ESP32) var updateChart = function () { // Nous récupérons les nouvelles données $.getJSON('/data', function(data) { // ajout de cette donnée dans notre liste de point dps.push({x: xVal, y: data[0].value}); // Mise à jour de la valeurs de la photorésistence element.innerHTML = data[0].value; }); xVal++; // Décalage du graphe et réaffichage avec la nouvelle valeurs if (dps.length > 10 ) { dps.shift(); } chart.render(); }; setInterval(function(){updateChart()}, updateInterval); } </script> <script type=\"text/javascript\" src=\"https://canvasjs.com/assets/script/canvasjs.min.js\"></script> </head> <body> <div id=\"chartContainer\" style=\"height: 300px; width: 100%;\"> </div> </div> </section> </body> <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script><script src=\"./script.js\"></script> <footer class=\"footer\"> <p class=\"footer_txt author\"> By Jules Maisonnave | Simon Beuvain | Wissam Saad El Masri | Clément Vandewalle</p> </footer></html>");

client.println(bmp.readTemperature());

client.println(bmp.readPressure());

client.println(bmp.readAltitude());

client.println(val); 
client.println(" PPM</span></td></tr>");
client.println("<tr><td>Humidité</td><td><span class=\"sensor\">");
client.println(h); 
client.println(" %</span></td></tr>");
client.println("</body></html>"); 
client.println();
Serial.println("Client disconnected.");
Serial.println("");
}
}
